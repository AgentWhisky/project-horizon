<mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" dynamicHeight>
  <mat-tab label="Dashboard">
    <div class="flex flex-col gap-3 p-3">
      @if(steamInsightDashboard() && dashboardLoadingStatus() === LOADING_STATUS.SUCCESS) {

      <!-- App Stats -->
      <hz-stat-card-group showPrimaryHeader>
        @for(stat of steamInsightDashboard()?.appStats; track stat) {
        <hz-stat-card>
          <hz-stat-card-title>{{ stat.displayName }}</hz-stat-card-title>
          <hz-stat-card-value>{{ stat.value }}</hz-stat-card-value>
        </hz-stat-card>
        }
      </hz-stat-card-group>

      <div class="grid grid-cols-2 gap-3">
        <!-- Running Update -->
        @if(runningUpdate()) {
        <hz-card>
          <hz-card-header>In-Progress Update</hz-card-header>
          <hz-card-chip>
            <hz-chip>Running</hz-chip>
          </hz-card-chip>
          <hz-card-body>
            <div class="flex flex-col gap-3">
              <div class="flex flex-col gap-3">
                <div class="flex flex-row gap-3">
                  <span>Start: {{ runningUpdate()!.startTime | date : 'short' }}</span>
                  <span>End: {{ runningUpdate()!.endTime | date : 'short' }}</span>
                </div>
                <span>Runtime:</span>
              </div>
              <div>
                <span class="font-medium">Events:</span>
                <ul class="list-disc list-inside text-gray-400">
                  @for (event of runningUpdate()!.events; track event) {
                  <li>{{ event }}</li>
                  }
                </ul>
              </div>
            </div>
          </hz-card-body>
        </hz-card>
        } @else {
        <hz-card>
          <hz-card-header>No In-Progress Update</hz-card-header>
          <hz-card-chip>
            <hz-chip>Not Running</hz-chip>
          </hz-card-chip>
          <hz-card-body>
            <div>Buttons</div>
          </hz-card-body>
        </hz-card>
        }

        <div class="grid gap-4">
          @for (update of steamInsightDashboard()?.recentUpdates; track update.id) {
          <hz-card>
            <hz-card-header>{{ getUpdateType(update.updateType) }} Update - [{{ update.id }}]</hz-card-header>
            <hz-card-chip>
              <hz-chip [type]="getUpdateStatusType(update.updateStatus)">{{ getUpdateStatus(update.updateStatus) }}</hz-chip>
            </hz-card-chip>

            <hz-card-body>
              <div class="grid grid-cols-2 w-full">
                <div class="flex flex-col gap-3">
                  <div class="flex flex-row gap-3">
                    <span>Start: {{ update.startTime | date : 'short' }}</span>
                    <span>End: {{ update.endTime | date : 'short' }}</span>
                  </div>
                  <span>Runtime: {{ getRuntime(update.startTime, update.endTime) | duration }}</span>
                </div>
              </div>
            </hz-card-body>
          </hz-card>

          }
        </div>
      </div>

      <!-- Handle Loading and Errors-->
      } @else if(dashboardLoadingStatus() === LOADING_STATUS.IN_PROGRESS) {
      <div class="w-full flex justify-center">
        <mat-spinner></mat-spinner>
      </div>
      } @else if(dashboardLoadingStatus() === LOADING_STATUS.FAILED) {
      <hz-banner type="error">
        <hz-banner-header>Steam Insight Dashboard Failed to load</hz-banner-header>
        <hz-banner-body>
          The system was unable to retrieve data required to render the Steam Insight Dashboard. This issue may be caused by a connectivity
          failure between the application and the backend service, a timeout during data retrieval, or a misconfigured server endpoint.
          Please verify that the server is online and accessible, and confirm that the API service responsible for dashboard data is running
          correctly.
        </hz-banner-body>
      </hz-banner>
      }
    </div>
  </mat-tab>
  <mat-tab label="Steam App Search">Content 2</mat-tab>
  <mat-tab label="Steam Update History">
    <div class="flex flex-col gap-3 p-3">
      <table mat-table [dataSource]="userDataSource" matSort #userSort="matSort" class="mat-elevation-z8">
        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by id">ID</th>
          <td mat-cell *matCellDef="let element">{{ element.id }}</td>
        </ng-container>

        <ng-container matColumnDef="username">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by username">Username</th>
          <td mat-cell *matCellDef="let element">{{ element.username }}</td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by name">Name</th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <ng-container matColumnDef="roles">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by roles">Roles</th>
          <td mat-cell *matCellDef="let element">
            <div class="flex flex-wrap gap-x-3 gap-y-1">
              @for(role of element.roles; track role.id) {
              <mat-chip [matTooltip]="role.description">{{ role.name }}</mat-chip>
              }
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="active">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by roles">Active</th>
          <td mat-cell *matCellDef="let element">{{ element.active ? 'Yes' : 'No' }}</td>
        </ng-container>

        <ng-container matColumnDef="lastLogin">
          <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by last login date">Last Login</th>
          <td mat-cell *matCellDef="let element">{{ element.lastLogin ? (element.lastLogin | date : 'short') : 'NONE' }}</td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef aria-hidden="true"></th>
          <td mat-cell class="min-w-16" *matCellDef="let element">
            <div class="flex justify-end items-center">
              <button
                mat-icon-button
                (click)="onToggleUser(element)"
                [attr.aria-label]="element.active ? 'Disable User' : 'Enable User'"
                [disabled]="element.id === currentUser?.userId">
                <mat-icon [matTooltip]="element.active ? 'Disable User' : 'Enable User'">
                  {{ element.active ? 'person' : 'person_off' }}
                </mat-icon>
              </button>
              <button mat-icon-button (click)="onEditUser(element)" aria-label="Edit User">
                <mat-icon matTooltip="Edit User">edit</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="userDisplayedColumns"></tr>
        <tr mat-row class="table-row" *matRowDef="let row; columns: userDisplayedColumns"></tr>
      </table>
      <mat-paginator [pageSizeOptions]="[25, 50, 100]" #userPaginator showFirstLastButtons aria-label="User Paginator"></mat-paginator>
    </div>
  </mat-tab>
</mat-tab-group>
